_p: &provider_aws
- aws:
    region: {{ .variables.region }}

name: local-template
kind: StackTemplate
cliVersion: "~>0.9.2"
units:
  -
    name: consul
    type: helm
    source:
      repository: "https://charts.bitnami.com/bitnami"
      chart: "consul"
      version: "10.9.12"
    provider_conf: {{ insertYAML .variables.k8s_conf }}
    additional_options:
      namespace: default
      create_namespace: true
    values:
      - file: ./values/consul.yaml
        apply_template: true
  -
    name: cert-manager-issuer
    type: kubernetes
    source: ./deployment.yaml
    provider_conf: {{ insertYAML .variables.k8s_conf }}
  -
    name: outputs
    type: printer
    outputs:
      new_output: "test2"

